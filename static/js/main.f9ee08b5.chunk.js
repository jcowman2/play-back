(this["webpackJsonpplay-back"]=this["webpackJsonpplay-back"]||[]).push([[0],{10:function(e,t,n){e.exports=n(22)},15:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){e.exports=n.p+"static/media/zig_____.fb74ba24.ttf"},22:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(8),o=n.n(a),s=(n(15),n(2)),l=n(4),c=n.n(l),u="freeze",d="restart",f="select",h="reverse",v="forward",y="move",p="moveEnd",m="rotate",b="rotateEnd",g=["space","r","ctrl","w","a","s","d","up","left","down","right","q","e","shift"],E=["w","a","s","d","up","left","down","right","q","e","shift"];var w=function(e){var t=e.onGameEvent,n=function(e,n){return t({type:e,data:n})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{handleKeys:g,onKeyEvent:function(e){switch(e){case"space":return n(u);case"r":return n(d);case"ctrl":return n(f);case"w":case"up":return n(y,"up");case"s":case"down":return n(y,"down");case"a":case"left":return n(y,"left");case"d":case"right":return n(y,"right");case"q":return n(m,"ccw");case"e":return n(m,"cw");case"shift":return n(h);default:return}}}),r.a.createElement(c.a,{handleEventType:"keyup",handleKeys:E,onKeyEvent:function(e){switch(e){case"w":case"up":return n(p,"up");case"s":case"down":return n(p,"down");case"a":case"left":return n(p,"left");case"d":case"right":return n(p,"right");case"q":return n(b,"ccw");case"e":return n(b,"cw");case"shift":return n(v);default:return}}}))};var x=function(e){var t=e.data,n=e.onEnterGoal,i=r.a.useRef();return r.a.useEffect((function(){i.current&&t&&!t.initialized&&(t.init(i.current,(function(){n()})),t.start())}),[i,t,n]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"stageInner",ref:i}),r.a.createElement(w,{onGameEvent:t.handleGameKeyEvent}))},S=n(1),M=function(e){return function(t){return e(t)}},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return M((function(i){return{body:S.Bodies.circle(i(e),i(t),i(n),{restitution:1,render:{fillStyle:"#D7DCE3"},friction:0,frictionAir:.025,density:1e-5}),meta:{gravity:!0,reversable:!0}}}))},B=function(e,t,n){return M((function(i){return{body:S.Bodies.rectangle(i(e),i(t),i(n),i(n),{isStatic:!0,isSensor:!0,render:{fillStyle:"#94FBAB"}}),meta:{}}}))},O=function(e){var t=e.live,n=e.color,i=e.selectColor,r=e.selectable,a=e.pushes,o=e.fixedRotation,s=e.fixedPosition;return function(e,l,c,u){var d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5?arguments[5]:void 0;return M((function(h){return{body:S.Bodies.rectangle(h(e),h(l),h(c),h(u),{isStatic:!0,angle:d,render:{fillStyle:n},friction:0,frictionAir:0}),meta:{live:t,color:n,selectColor:i,selectable:r,pushes:a,fixedRotation:o,bounded:f,fixedPosition:s}}}))}},z=O({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0}),j=O({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0,fixedPosition:!0}),k=O({color:"#7E262E",selectColor:"#AD343E",selectable:!0,fixedRotation:!0,pushes:!0}),P=O({color:"#1D3742"}),R=function(e,t,n,i,r){return M((function(a){return{body:S.Bodies.rectangle(a(e),a(t),a(n),a(i),{isSensor:!0,render:{fillStyle:r,opacity:.5}}),meta:{color:r}}}))},V=n(3),A=n(6),D=function e(t,n){var i=this;Object(V.a)(this,e),this.startMove=function(e){i[e]=!0},this.stopMove=function(e){i[e]=!1},this.getVelocity=function(){return{x:((i.left?-1:0)+(i.right?1:0))*i.speed/1e3,y:((i.up?-1:0)+(i.down?1:0))*i.speed/1e3}},this.getAngularVelocity=function(){return((i.ccw?-1:0)+(i.cw?1:0))*i.angularSpeed/1e3},this.isMoving=function(){var e=i.getVelocity(),t=e.x,n=e.y;return t||n||i.getAngularVelocity()},this.speed=t,this.angularSpeed=n;for(var r=0,a=["up","down","left","right","cw","ccw"];r<a.length;r++){this[a[r]]=!1}},C=function e(t){var n=this;Object(V.a)(this,e),this.log=function(e){var t=n.history.length?n.history[n.history.length-1].position:n.body.position,i=S.Vector.sub(n.body.position,t),r=n.body.position,a=r.x,o=r.y;n.history.push({time:e,position:{x:a,y:o},delta:i})},this.clear=function(){n.history=[]},this.revertTo=function(e){for(var t=S.Vector.create(),i=n.history.length-1;i>=0;i--){var r=n.history[i],a=r.time,o=r.delta;if(t=S.Vector.sub(t,o),!(a>e)){S.Body.translate(n.body,t),n.history.splice(i,n.history.length);break}}},this.body=t,this.history=[]},I=["gravity","selectable","reversable","fixedRotation","bounded","fixedPosition"],F=function e(t,n){var i=this;Object(V.a)(this,e),this.start=function(){i.frozenVelocities={},i.activeObjectIndex=0,i.selectMovement=new D(i.normalize(500),20)},this.attachEventListeners=function(){i.registerCollisionListener("spirit","goal",i.level.onEnterGoal)},this.registerCollisionListener=function(e,t,n){var r=i.bodyMap[e].id,a=i.bodyMap[t].id;S.Events.on(i.level.loop.engine,"collisionStart",(function(e){var t,i=Object(A.a)(e.pairs);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=o.bodyA,l=o.bodyB;if(s.id===r&&l.id===a||s.id===a&&l.id===r)return n()}}catch(c){i.e(c)}finally{i.f()}}))},this.normalize=function(e){return e/100*700},this.update=function(){i.updatePushes(),i.updateGravityBodies(),i.updateSelectables(),i.updateHistories(),i.updateReversables(),i.updateFixedRotations(),i.updateBoundeds(),i.updateFixedPositions(),i.checkSpiritOutOfBounds()},this.updatePushes=function(){var e=i.level.objectSelectOrder[i.activeObjectIndex],t=!i.metaMap[e].pushes&&i.level.frozen;i.byTrait.gravity.forEach((function(e){i.bodyMap[e].isStatic!==t&&S.Body.setStatic(i.bodyMap[e],t)}))},this.updateGravityBodies=function(){var e={x:0,y:0},t=i.level.frozen?function(t){S.Body.setVelocity(t,e)}:function(e){var t={x:0*e.mass,y:.002*e.mass};S.Body.applyForce(e,e.position,t)};i.byTrait.gravity.forEach((function(e){t(i.bodyMap[e])}))},this.updateSelectables=function(){var e=i.level.objectSelectOrder[i.activeObjectIndex];i.byTrait.selectable.forEach((function(t){var n=i.bodyMap[t],r=i.metaMap[t],a=r.color,o=r.selectColor,s=r.live,l=r.fixedRotation,c=r.fixedPosition,u=i.selectMovement;u.isMoving()||n.isStatic||S.Body.setStatic(n,!0);var d=t===e,f=!!s!==i.level.frozen,h=a;d&&f&&(h=o,u.isMoving()&&(S.Body.setStatic(n,!1),c||S.Body.setVelocity(n,u.getVelocity()),l||S.Body.setAngularVelocity(n,u.getAngularVelocity()))),n.render.fillStyle=h}))},this.updateHistories=function(){i.level.frozen||i.byTrait.reversable.forEach((function(e){i.histories[e].log(i.level.getPlayTime())}))},this.updateReversables=function(){if(i.level.reversed){var e=i.level.getPlayTime();for(var t in i.histories)i.histories[t].revertTo(e)}},this.updateFixedRotations=function(){i.byTrait.fixedRotation.forEach((function(e){S.Body.setAngle(i.bodyMap[e],0)}))},this.updateFixedPositions=function(){i.byTrait.fixedPosition.forEach((function(e){var t=i.fixedPositions[e],n=t.x,r=t.y;S.Body.setPosition(i.bodyMap[e],{x:n,y:r})}))},this.checkSpiritOutOfBounds=function(){var e=i.bodyMap.spirit.position,t=e.x,n=e.y,r=-i.normalize(20),a=700+i.normalize(20);(t<=r||n<=r||t>=a||n>=a)&&i.level.onSpiritOutOfBounds()},this.updateBoundeds=function(){var e=i.normalize(1);i.byTrait.bounded.forEach((function(t){var n=i.bodyMap[t],r=i.metaMap[t].bounded,a=i.bodyMap[r],o=Object(s.a)(n.vertices,4),l=o[0],c=o[1],u=o[2],d=o[3],f=Object(s.a)(a.vertices,3),h=f[0],v=f[2],y=0,p=0,m=Math.min(l.y,c.y),b=Math.min(l.x,d.x),g=Math.max(u.y,d.y),E=Math.max(u.x,c.x),w=h.y+e,x=h.x+e,M=v.y-e,T=v.x-e;m<w&&(p+=w-m),g>M&&(p-=g-M),b<x&&(y+=x-b),E>T&&(y-=E-T),(y||p)&&S.Body.translate(n,{x:y,y:p})}))},this.freeze=function(){var e={};i.byTrait.gravity.forEach((function(t){var n=i.bodyMap[t].velocity,r=n.x,a=n.y;e[t]={x:r,y:a}})),i.frozenVelocities=e},this.unfreeze=function(){i.byTrait.gravity.forEach((function(e){var t=i.frozenVelocities[e];if(t){var n=t.x,r=t.y;S.Body.setVelocity(i.bodyMap[e],{x:n,y:r})}}))},this.selectNext=function(){var e=i.activeObjectIndex+1;e>=i.level.objectSelectOrder.length&&(e=0),i.activeObjectIndex=e},this.moveSelected=function(e){i.selectMovement.startMove(e)},this.stopMovingSelected=function(e){i.selectMovement.stopMove(e)},this.level=t;var r=[],a={},o={},l={},c={},u={};for(var d in I.forEach((function(e){return u[e]=[]})),n){var f=n[d](this.normalize),h=f.body,v=f.meta;r.push(h),a[d]=h,o[d]=v;var y,p=Object(A.a)(I);try{for(p.s();!(y=p.n()).done;){var m=y.value;void 0!==v[m]&&u[m].push(d)}}catch(w){p.e(w)}finally{p.f()}if(v.reversable&&(l[d]=new C(h)),v.fixedPosition){var b=h.position,g=b.x,E=b.y;c[d]={x:g,y:E}}}this.all=r,this.bodyMap=a,this.metaMap=o,this.byTrait=u,this.histories=l,this.fixedPositions=c},K=function e(t,n){var i=this;Object(V.a)(this,e),this.start=function(e,t,n){i.render=S.Render.create({element:e,engine:i.engine,options:{wireframes:!1,width:700,height:700,background:"#03171B"}}),S.Render.world(i.render),i.intervalRef=setInterval(i.update,10),i.playTime=0},this.update=function(){i.globalTime+=10,i.level.reversed?i.playTime=Math.max(0,i.playTime-10):i.level.frozen||(i.playTime+=10),i.level.blockingEvent||(i.level.update(),S.Engine.update(i.engine,10),S.Render.world(i.render))},this.teardown=function(){i.intervalRef=clearInterval(i.intervalRef),S.Render.stop(i.render),S.World.clear(i.engine.world),S.Engine.clear(i.engine),i.render.canvas.remove(),setTimeout((function(){i.render.canvas=null,i.render.context=null,i.render.textures={}}),10)},this.level=t,this.globalTime=0,this.engine=S.Engine.create(),this.engine.world.gravity.scale=0,S.World.add(this.engine.world,n)},G=function e(t,n){var i=this;Object(V.a)(this,e),this.init=function(e,t,n){i.ref=e,i.onEnterGoal=t,i.initialized=!0},this.start=function(){i.bodies=new F(i,i.bodiesInitializer),i.loop=new K(i,i.bodies.all),i.bodies.start(),i.loop.start(i.ref),i.bodies.attachEventListeners(),i.started=!0,i.frozen=!0,i.events=[],i.blockingEvent=!1},this.update=function(){if(i.events.length){i.blockingEvent=!0;var e=i.events.shift();i.executeEvent(e),i.blockingEvent=!1}i.bodies.update()},this.handleGameKeyEvent=function(e){i.events.push(e)},this.executeEvent=function(e){var t=e.type,n=e.data;switch(t){case u:return i.frozen?i.unfreeze():i.freeze();case d:return i.restart();case f:return i.bodies.selectNext();case y:case m:return i.bodies.moveSelected(n);case p:case b:return i.bodies.stopMovingSelected(n);case h:return i.reverse();case v:return i.forward();default:console.log("not handled",t)}},this.teardown=function(){i.loop.teardown()},this.restart=function(){i.teardown(),i.start()},this.getPlayTime=function(){return i.loop.playTime},this.freeze=function(){i.frozen=!0,i.bodies.freeze()},this.unfreeze=function(){i.frozen=!1,i.bodies.unfreeze()},this.reverse=function(){i.freeze(),i.reversed=!0},this.forward=function(){i.reversed=!1},this.onSpiritOutOfBounds=function(){i.restart()},this.bodiesInitializer=t,this.objectSelectOrder=n,this.initialized=!1},L=[{name:"Lander",level:function(){return new G({spirit:T(10,10,2),ground:z(42,80,80,2),goal:B(90,90,4)},["ground"])}},{name:"Landerer",level:function(){return new G({spirit:T(10,10,2),ground:z(42,80,30,2),goal:B(90,90,4)},["ground"])}},{name:"Push",level:function(){return new G({goal:B(90,90,4),spirit:T(20,10,2),pusherBound:R(45,60,80,10,"#7E262E"),pusher:k(10,60,8,8,0,"pusherBound"),ground:P(20,30,30,2,.5)},["pusher"])}},{name:"Tower",level:function(){return new G({goal:B(50,20,4),spirit:T(20,10,2),pusherBound:R(50,90,90,10,"#7E262E"),pusher:k(90,90,8,8,0,"pusherBound"),wall1:P(50,10,24,2),wall2:P(39,45,2,70),wall3:P(61,45,2,70)},["pusher"])}},{name:"Plateau",level:function(){return new G({goal:B(20,80,4),spirit:T(10,5,2),topWall:j(40,30,70,2),goalShield:P(20,65,50,2,-.5),pusherBound:R(80,80,38,38,"#7E262E"),pusher:k(90,90,8,8,0,"pusherBound")},["topWall","pusher"])}}];var N=function(e){e.onSetLevel;var t=e.onAnyKey;return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{handleKeys:["numeric"],onKeyEvent:function(e){0}}),r.a.createElement(c.a,{handleKeys:["all"],onKeyEvent:t}))},W=(n(20),n(21),n(9)),q=n.n(W);function _(e){e.totalRetries;return r.a.createElement("div",{className:"TutorialSlide"},r.a.createElement("div",null,"As you roll the orb into the last goal, the VHS sputters out. For the last time, you guess."),r.a.createElement("div",null,'From far away, you hear a quiet voice: "My thanks"'),r.a.createElement("div",{style:{opacity:.6}},"Thank you for playing Play<<Back! This game was created in 48 hours for Ludum Dare 46. If you have any feedback, go to github.com/jcowman2/play-back"),r.a.createElement("div",{style:{opacity:.6,textAlign:"right"}},"-Joe"))}var H=[function(){return r.a.createElement("img",{src:q.a,alt:"PlayBack Title"})},function(){return r.a.createElement("div",{className:"TutorialSlide"},r.a.createElement("div",null,"It is a warm Wednesday night the summer after you turned ten."),r.a.createElement("div",null,"Searching for something to do at your grandparents' house, you stumble upon a dusty old TV with a VCR."),r.a.createElement("div",null,"Something about the VCR calls to you."),r.a.createElement("div",null,'Suddenly, a tiny orb blinks onto the screen. "Save me" it says....'),r.a.createElement("div",{style:{opacity:.3}},"Press any key to continue."))}];var J=function(){var e=r.a.useState(),t=Object(s.a)(e,2),n=t[0],i=t[1],a=r.a.useState(),o=Object(s.a)(a,2),l=o[0],c=o[1],u=r.a.useState(0),d=Object(s.a)(u,2)[1],f=r.a.useState(0),h=Object(s.a)(f,2),v=h[0],y=h[1],p=function(){var e=r.a.useState(!0),t=Object(s.a)(e,2),n=t[0],i=t[1],a=r.a.useState("INPUT"),o=Object(s.a)(a,2),l=o[0],c=o[1],u=r.a.useState(3e3),d=Object(s.a)(u,2),f=d[0],h=d[1];return r.a.useEffect((function(){!l||f<0||setTimeout((function(){return c(null)}),f)}),[l,f]),{setAnimate:i,monitorClass:"Monitor"+(n?" TurnOn":""),overlayText:l,setOverlayText:c,setOverlayTextDuration:h}}(),m=p.setAnimate,b=p.monitorClass,g=p.overlayText,E=p.setOverlayText,w=function(e){l&&l.teardown(),i(e),c(L[e].level()),m(!0),E(function(e){return"".concat(e+1,": ").concat(L[e].name)}(e))},S=v<0?r.a.createElement(_,{totalRetries:0}):H[v]();return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:b,onAnimationEnd:function(){return m(!1)}},r.a.createElement("div",{className:"Screen"},l?r.a.createElement(x,{data:l,onUpdateData:function(){d((function(e){return e+1}))},onEnterGoal:function(){n===L.length-1?(c(null),y(-1)):w(n+1)}}):S),r.a.createElement("div",{className:"Overlay"},g)),r.a.createElement(N,{onSetLevel:w,onAnyKey:function(){l||(v===H.length-1?w(0):y((function(e){return e+1})))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n.p+"static/media/LD Square.ad3b42a3.png"}},[[10,1,2]]]);
//# sourceMappingURL=main.f9ee08b5.chunk.js.map