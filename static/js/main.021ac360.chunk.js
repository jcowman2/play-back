(this["webpackJsonpplay-back"]=this["webpackJsonpplay-back"]||[]).push([[0],{10:function(e,t,n){e.exports=n(22)},15:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){e.exports=n.p+"static/media/zig_____.fb74ba24.ttf"},22:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(8),o=n.n(r),s=(n(15),n(2)),l=n(4),c=n.n(l),u="freeze",d="restart",f="select",h="reverse",v="forward",y="move",p="moveEnd",m="rotate",b="rotateEnd",g=["space","r","ctrl","w","a","s","d","up","left","down","right","q","e","shift"],E=["w","a","s","d","up","left","down","right","q","e","shift"];var w=function(e){var t=e.onGameEvent,n=function(e,n){return t({type:e,data:n})};return i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{handleKeys:g,onKeyEvent:function(e){switch(e){case"space":return n(u);case"r":return n(d);case"ctrl":return n(f);case"w":case"up":return n(y,"up");case"s":case"down":return n(y,"down");case"a":case"left":return n(y,"left");case"d":case"right":return n(y,"right");case"q":return n(m,"ccw");case"e":return n(m,"cw");case"shift":return n(h);default:return}}}),i.a.createElement(c.a,{handleEventType:"keyup",handleKeys:E,onKeyEvent:function(e){switch(e){case"w":case"up":return n(p,"up");case"s":case"down":return n(p,"down");case"a":case"left":return n(p,"left");case"d":case"right":return n(p,"right");case"q":return n(b,"ccw");case"e":return n(b,"cw");case"shift":return n(v);default:return}}}))};var x=function(e){var t=e.data,n=e.onEnterGoal,a=i.a.useRef();return i.a.useEffect((function(){a.current&&t&&!t.initialized&&(t.init(a.current,(function(){n()})),t.start())}),[a,t,n]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"stageInner",ref:a}),i.a.createElement(w,{onGameEvent:t.handleGameKeyEvent}))},S=n(1),T=function(e){return function(t){return e(t)}},M=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return T((function(a){return{body:S.Bodies.circle(a(e),a(t),a(n),{restitution:1,render:{fillStyle:"#D7DCE3"},friction:0,frictionAir:.025,density:1e-5}),meta:{gravity:!0,reversable:!0}}}))},O=function(e,t,n){return T((function(a){return{body:S.Bodies.rectangle(a(e),a(t),a(n),a(n),{isStatic:!0,isSensor:!0,render:{fillStyle:"#94FBAB"}}),meta:{}}}))},B=function(e){var t=e.live,n=e.color,a=e.selectColor,i=e.selectable,r=e.pushes,o=e.fixedRotation,s=e.fixedPosition;return function(e,l,c,u){var d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5?arguments[5]:void 0;return T((function(h){return{body:S.Bodies.rectangle(h(e),h(l),h(c),h(u),{isStatic:!0,angle:d,render:{fillStyle:n},friction:0,frictionAir:0}),meta:{live:t,color:n,selectColor:a,selectable:i,pushes:r,fixedRotation:o,bounded:f,fixedPosition:s}}}))}},z=B({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0}),j=B({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0,fixedPosition:!0}),k=B({color:"#7E262E",selectColor:"#AD343E",selectable:!0,fixedRotation:!0,pushes:!0}),P=B({color:"#1D3742"}),R=function(e,t,n,a,i){return T((function(r){return{body:S.Bodies.rectangle(r(e),r(t),r(n),r(a),{isSensor:!0,render:{fillStyle:i,opacity:.5}}),meta:{color:i}}}))},A=n(3),V=n(6),C=function e(t,n){var a=this;Object(A.a)(this,e),this.startMove=function(e){a[e]=!0},this.stopMove=function(e){a[e]=!1},this.getVelocity=function(){return{x:((a.left?-1:0)+(a.right?1:0))*a.speed/1e3,y:((a.up?-1:0)+(a.down?1:0))*a.speed/1e3}},this.getAngularVelocity=function(){return((a.ccw?-1:0)+(a.cw?1:0))*a.angularSpeed/1e3},this.isMoving=function(){var e=a.getVelocity(),t=e.x,n=e.y;return t||n||a.getAngularVelocity()},this.speed=t,this.angularSpeed=n;for(var i=0,r=["up","down","left","right","cw","ccw"];i<r.length;i++){this[r[i]]=!1}},D=function e(t){var n=this;Object(A.a)(this,e),this.log=function(e){var t=n.history.length?n.history[n.history.length-1].position:n.body.position,a=S.Vector.sub(n.body.position,t),i=n.body.position,r=i.x,o=i.y;n.history.push({time:e,position:{x:r,y:o},delta:a})},this.clear=function(){n.history=[]},this.revertTo=function(e){for(var t=S.Vector.create(),a=n.history.length-1;a>=0;a--){var i=n.history[a],r=i.time,o=i.delta;if(t=S.Vector.sub(t,o),!(r>e)){S.Body.translate(n.body,t),n.history.splice(a,n.history.length);break}}},this.body=t,this.history=[]},I=["gravity","selectable","reversable","fixedRotation","bounded","fixedPosition"],F=function e(t,n){var a=this;Object(A.a)(this,e),this.start=function(){a.frozenVelocities={},a.activeObjectIndex=0,a.selectMovement=new C(a.normalize(500),20)},this.attachEventListeners=function(){a.registerCollisionListener("spirit","goal",a.level.onEnterGoal)},this.registerCollisionListener=function(e,t,n){var i=a.bodyMap[e].id,r=a.bodyMap[t].id;S.Events.on(a.level.loop.engine,"collisionStart",(function(e){var t,a=Object(V.a)(e.pairs);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.bodyA,l=o.bodyB;if(s.id===i&&l.id===r||s.id===r&&l.id===i)return n()}}catch(c){a.e(c)}finally{a.f()}}))},this.normalize=function(e){return e/100*700},this.update=function(){a.updatePushes(),a.updateGravityBodies(),a.updateSelectables(),a.updateHistories(),a.updateReversables(),a.updateFixedRotations(),a.updateBoundeds(),a.updateFixedPositions(),a.checkSpiritOutOfBounds()},this.updatePushes=function(){var e=a.level.objectSelectOrder[a.activeObjectIndex],t=!a.metaMap[e].pushes&&a.level.frozen;a.byTrait.gravity.forEach((function(e){a.bodyMap[e].isStatic!==t&&S.Body.setStatic(a.bodyMap[e],t)}))},this.updateGravityBodies=function(){var e={x:0,y:0},t=a.level.frozen?function(t){S.Body.setVelocity(t,e)}:function(e){var t={x:0*e.mass,y:.002*e.mass};S.Body.applyForce(e,e.position,t)};a.byTrait.gravity.forEach((function(e){t(a.bodyMap[e])}))},this.updateSelectables=function(){var e=a.level.objectSelectOrder[a.activeObjectIndex];a.byTrait.selectable.forEach((function(t){var n=a.bodyMap[t],i=a.metaMap[t],r=i.color,o=i.selectColor,s=i.live,l=i.fixedRotation,c=i.fixedPosition,u=a.selectMovement;u.isMoving()||n.isStatic||S.Body.setStatic(n,!0);var d=t===e,f=!!s!==a.level.frozen,h=r;d&&f&&(h=o,u.isMoving()&&(S.Body.setStatic(n,!1),c||S.Body.setVelocity(n,u.getVelocity()),l||S.Body.setAngularVelocity(n,u.getAngularVelocity()))),n.render.fillStyle=h}))},this.updateHistories=function(){a.level.frozen||a.byTrait.reversable.forEach((function(e){a.histories[e].log(a.level.getPlayTime())}))},this.updateReversables=function(){if(a.level.reversed){var e=a.level.getPlayTime();for(var t in a.histories)a.histories[t].revertTo(e)}},this.updateFixedRotations=function(){a.byTrait.fixedRotation.forEach((function(e){S.Body.setAngle(a.bodyMap[e],0)}))},this.updateFixedPositions=function(){a.byTrait.fixedPosition.forEach((function(e){var t=a.fixedPositions[e],n=t.x,i=t.y;S.Body.setPosition(a.bodyMap[e],{x:n,y:i})}))},this.checkSpiritOutOfBounds=function(){var e=a.bodyMap.spirit.position,t=e.x,n=e.y,i=-a.normalize(20),r=700+a.normalize(20);(t<=i||n<=i||t>=r||n>=r)&&a.level.onSpiritOutOfBounds()},this.updateBoundeds=function(){var e=a.normalize(1);a.byTrait.bounded.forEach((function(t){var n=a.bodyMap[t],i=a.metaMap[t].bounded,r=a.bodyMap[i],o=Object(s.a)(n.vertices,4),l=o[0],c=o[1],u=o[2],d=o[3],f=Object(s.a)(r.vertices,3),h=f[0],v=f[2],y=0,p=0,m=Math.min(l.y,c.y),b=Math.min(l.x,d.x),g=Math.max(u.y,d.y),E=Math.max(u.x,c.x),w=h.y+e,x=h.x+e,T=v.y-e,M=v.x-e;m<w&&(p+=w-m),g>T&&(p-=g-T),b<x&&(y+=x-b),E>M&&(y-=E-M),(y||p)&&S.Body.translate(n,{x:y,y:p})}))},this.freeze=function(){var e={};a.byTrait.gravity.forEach((function(t){var n=a.bodyMap[t].velocity,i=n.x,r=n.y;e[t]={x:i,y:r}})),a.frozenVelocities=e},this.unfreeze=function(){a.byTrait.gravity.forEach((function(e){var t=a.frozenVelocities[e];if(t){var n=t.x,i=t.y;S.Body.setVelocity(a.bodyMap[e],{x:n,y:i})}}))},this.selectNext=function(){var e=a.activeObjectIndex+1;e>=a.level.objectSelectOrder.length&&(e=0),a.activeObjectIndex=e},this.moveSelected=function(e){a.selectMovement.startMove(e)},this.stopMovingSelected=function(e){a.selectMovement.stopMove(e)},this.level=t;var i=[],r={},o={},l={},c={},u={};for(var d in I.forEach((function(e){return u[e]=[]})),n){var f=n[d](this.normalize),h=f.body,v=f.meta;i.push(h),r[d]=h,o[d]=v;var y,p=Object(V.a)(I);try{for(p.s();!(y=p.n()).done;){var m=y.value;void 0!==v[m]&&u[m].push(d)}}catch(w){p.e(w)}finally{p.f()}if(v.reversable&&(l[d]=new D(h)),v.fixedPosition){var b=h.position,g=b.x,E=b.y;c[d]={x:g,y:E}}}this.all=i,this.bodyMap=r,this.metaMap=o,this.byTrait=u,this.histories=l,this.fixedPositions=c},W=function e(t,n){var a=this;Object(A.a)(this,e),this.start=function(e,t,n){a.render=S.Render.create({element:e,engine:a.engine,options:{wireframes:!1,width:700,height:700,background:"#03171B"}}),S.Render.world(a.render),a.intervalRef=setInterval(a.update,10),a.playTime=0},this.update=function(){a.globalTime+=10,a.level.reversed?a.playTime=Math.max(0,a.playTime-10):a.level.frozen||(a.playTime+=10),a.level.blockingEvent||(a.level.update(),S.Engine.update(a.engine,10),S.Render.world(a.render))},this.teardown=function(){a.intervalRef=clearInterval(a.intervalRef),S.Render.stop(a.render),S.World.clear(a.engine.world),S.Engine.clear(a.engine),a.render.canvas.remove(),setTimeout((function(){a.render.canvas=null,a.render.context=null,a.render.textures={}}),10)},this.level=t,this.globalTime=0,this.engine=S.Engine.create(),this.engine.world.gravity.scale=0,S.World.add(this.engine.world,n)},K=function e(t,n){var a=this;Object(A.a)(this,e),this.init=function(e,t,n){a.ref=e,a.onEnterGoal=t,a.initialized=!0},this.start=function(){a.bodies=new F(a,a.bodiesInitializer),a.loop=new W(a,a.bodies.all),a.bodies.start(),a.loop.start(a.ref),a.bodies.attachEventListeners(),a.started=!0,a.frozen=!0,a.events=[],a.blockingEvent=!1},this.update=function(){if(a.events.length){a.blockingEvent=!0;var e=a.events.shift();a.executeEvent(e),a.blockingEvent=!1}a.bodies.update()},this.handleGameKeyEvent=function(e){a.events.push(e)},this.executeEvent=function(e){var t=e.type,n=e.data;switch(t){case u:return a.frozen?a.unfreeze():a.freeze();case d:return a.restart();case f:return a.bodies.selectNext();case y:case m:return a.bodies.moveSelected(n);case p:case b:return a.bodies.stopMovingSelected(n);case h:return a.reverse();case v:return a.forward();default:console.log("not handled",t)}},this.teardown=function(){a.loop.teardown()},this.restart=function(){a.teardown(),a.start()},this.getPlayTime=function(){return a.loop.playTime},this.freeze=function(){a.frozen=!0,a.bodies.freeze()},this.unfreeze=function(){a.frozen=!1,a.bodies.unfreeze()},this.reverse=function(){a.freeze(),a.reversed=!0},this.forward=function(){a.reversed=!1},this.onSpiritOutOfBounds=function(){a.restart()},this.bodiesInitializer=t,this.objectSelectOrder=n,this.initialized=!1},L=[{name:"Lander",level:function(){return new K({spirit:M(10,10,2),ground:z(42,80,80,2),goal:O(90,90,4)},["ground"])}},{name:"Landerer",level:function(){return new K({spirit:M(10,10,2),ground:z(42,80,30,2),goal:O(90,90,4)},["ground"])}},{name:"Push",level:function(){return new K({goal:O(90,90,4),spirit:M(20,10,2),pusherBound:R(45,60,80,10,"#7E262E"),pusher:k(10,60,8,8,0,"pusherBound"),ground:P(20,30,30,2,.5)},["pusher"])}},{name:"Tower",level:function(){return new K({goal:O(50,20,4),spirit:M(20,10,2),pusherBound:R(50,90,90,10,"#7E262E"),pusher:k(90,90,8,8,0,"pusherBound"),wall1:P(50,10,24,2),wall2:P(39,45,2,70),wall3:P(61,45,2,70)},["pusher"])}},{name:"Plateau",level:function(){return new K({goal:O(20,80,4),spirit:M(10,5,2),topWall:j(40,30,70,2),goalShield:P(20,65,50,2,-.5),pusherBound:R(80,80,38,38,"#7E262E"),pusher:k(90,90,8,8,0,"pusherBound")},["topWall","pusher"])}}];var G=function(e){e.onSetLevel;var t=e.onAnyKey;return i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{handleKeys:["numeric"],onKeyEvent:function(e){0}}),i.a.createElement(c.a,{handleKeys:["all"],onKeyEvent:t}))},N=(n(20),n(21),n(9)),q=n.n(N);function H(e){e.totalRetries;return i.a.createElement("div",{className:"TutorialSlide"},i.a.createElement("div",null,"As you roll the orb into the last goal, the VHS sputters out. For the last time, you guess."),i.a.createElement("div",null,'From far away, you hear a quiet voice: "My thanks"'),i.a.createElement("div",{style:{opacity:.6}},"Thank you for playing Play<<Back! This game was created in 48 hours for Ludum Dare 46. If you have any feedback, go to github.com/jcowman2/play-back"),i.a.createElement("div",{style:{opacity:.6,textAlign:"right"}},"-Joe"))}var _=[function(){return i.a.createElement("img",{src:q.a,alt:"PlayBack Title"})},function(){return i.a.createElement("div",{className:"TutorialSlide"},i.a.createElement("div",null,"It is a warm Wednesday night the summer after you turned ten."),i.a.createElement("div",null,"Searching for something to do at your grandparents' house, you stumble upon a dusty old TV with a VCR."),i.a.createElement("div",null,"Something about the VCR calls to you."),i.a.createElement("div",null,'Suddenly, a tiny orb blinks onto the screen. "Save me" it says....'),i.a.createElement("div",{style:{opacity:.3}},"Press any key to continue."))}],J=[i.a.createElement("div",{style:{left:400,top:50,maxWidth:300}},i.a.createElement("div",null,"Try to get the ball into the goal."),i.a.createElement("div",null,"Use WASD to move the platform, and QE to rotate it."),i.a.createElement("div",null,"Hit play/pause with SPACE.")),i.a.createElement("div",{style:{left:300,top:150,maxWidth:400}},i.a.createElement("div",null,"You can use time to your advantage!")),i.a.createElement("div",{style:{left:300,top:100,maxWidth:400}},i.a.createElement("div",null,"Red walls can push the orb around when time is stopped, but they can't leave their area.")),i.a.createElement("div",{style:{left:220,top:10,maxWidth:400}},i.a.createElement("div",null,"Hold SHIFT to rewind!")),i.a.createElement("div",{style:{left:220,top:10,maxWidth:400}},i.a.createElement("div",null,"Press CTRL to switch control between blocks."),i.a.createElement("div",null,"Some blocks can only rotate in place."))];var U=function(){var e=i.a.useState(),t=Object(s.a)(e,2),n=t[0],a=t[1],r=i.a.useState(),o=Object(s.a)(r,2),l=o[0],c=o[1],u=i.a.useState(0),d=Object(s.a)(u,2)[1],f=i.a.useState(0),h=Object(s.a)(f,2),v=h[0],y=h[1],p=function(){var e=i.a.useState(!0),t=Object(s.a)(e,2),n=t[0],a=t[1],r=i.a.useState("INPUT"),o=Object(s.a)(r,2),l=o[0],c=o[1],u=i.a.useState(3e3),d=Object(s.a)(u,2),f=d[0],h=d[1];return i.a.useEffect((function(){!l||f<0||setTimeout((function(){return c(null)}),f)}),[l,f]),{setAnimate:a,monitorClass:"Monitor"+(n?" TurnOn":""),overlayText:l,setOverlayText:c,setOverlayTextDuration:h}}(),m=p.setAnimate,b=p.monitorClass,g=p.overlayText,E=p.setOverlayText,w=function(e){l&&l.teardown(),a(e),c(L[e].level()),m(!0),E(function(e){return"".concat(e+1,": ").concat(L[e].name)}(e))},S=v<0?i.a.createElement(H,{totalRetries:0}):_[v]();return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:b,onAnimationEnd:function(){return m(!1)}},i.a.createElement("div",{className:"Screen"},l?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"InstructionOverlay"},J[n]),i.a.createElement(x,{data:l,onUpdateData:function(){d((function(e){return e+1}))},onEnterGoal:function(){n===L.length-1?(c(null),y(-1)):w(n+1)}})):S),i.a.createElement("div",{className:"Overlay"},g)),i.a.createElement(G,{onSetLevel:w,onAnyKey:function(){l||(v===_.length-1?w(0):y((function(e){return e+1})))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n.p+"static/media/LD Square.ad3b42a3.png"}},[[10,1,2]]]);
//# sourceMappingURL=main.021ac360.chunk.js.map