(this["webpackJsonpplay-back"]=this["webpackJsonpplay-back"]||[]).push([[0],{10:function(e,t,n){e.exports=n(22)},15:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){e.exports=n.p+"static/media/zig_____.fb74ba24.ttf"},22:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),i=n.n(r),o=n(8),s=n.n(o),l=(n(15),n(2)),c=n(4),u=n.n(c),d="freeze",f="restart",v="select",h="reverse",y="forward",m="move",p="moveEnd",b="rotate",g="rotateEnd",E=["space","r","ctrl","w","a","s","d","up","left","down","right","q","e","shift"],w=["w","a","s","d","up","left","down","right","q","e","shift"];var x=function(e){var t=e.onGameEvent,n=function(e,n){return t({type:e,data:n})};return i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{handleKeys:E,onKeyEvent:function(e){switch(e){case"space":return n(d);case"r":return n(f);case"ctrl":return n(v);case"w":case"up":return n(m,"up");case"s":case"down":return n(m,"down");case"a":case"left":return n(m,"left");case"d":case"right":return n(m,"right");case"q":return n(b,"ccw");case"e":return n(b,"cw");case"shift":return n(h);default:return}}}),i.a.createElement(u.a,{handleEventType:"keyup",handleKeys:w,onKeyEvent:function(e){switch(e){case"w":case"up":return n(p,"up");case"s":case"down":return n(p,"down");case"a":case"left":return n(p,"left");case"d":case"right":return n(p,"right");case"q":return n(g,"ccw");case"e":return n(g,"cw");case"shift":return n(y);default:return}}}))};var S=function(e){var t=e.data,n=e.onEnterGoal,a=i.a.useRef();return i.a.useEffect((function(){a.current&&t&&!t.initialized&&(t.init(a.current,(function(){n()})),t.start())}),[a,t,n]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"stageInner",ref:a}),i.a.createElement(x,{onGameEvent:t.handleGameKeyEvent}))},T=n(1),O=function(e){return function(t){return e(t)}},B=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return O((function(a){return{body:T.Bodies.circle(a(e),a(t),a(n),{restitution:1,render:{fillStyle:"#D7DCE3"},friction:0,frictionAir:.025,density:1e-5}),meta:{gravity:!0,reversable:!0}}}))},M=function(e,t,n){return O((function(a){return{body:T.Bodies.rectangle(a(e),a(t),a(n),a(n),{isStatic:!0,isSensor:!0,render:{fillStyle:"#94FBAB"}}),meta:{}}}))},z=function(e){var t=e.live,n=e.color,a=e.selectColor,r=e.selectable,i=e.pushes,o=e.fixedRotation,s=e.fixedPosition;return function(e,l,c,u){var d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5?arguments[5]:void 0;return O((function(v){return{body:T.Bodies.rectangle(v(e),v(l),v(c),v(u),{isStatic:!0,angle:d,render:{fillStyle:n},friction:0,frictionAir:0}),meta:{live:t,color:n,selectColor:a,selectable:r,pushes:i,fixedRotation:o,bounded:f,fixedPosition:s}}}))}},j=z({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0}),k=z({color:"#6D7F8D",selectColor:"#D7DCE3",selectable:!0,fixedPosition:!0}),P=z({color:"#7E262E",selectColor:"#AD343E",selectable:!0,fixedRotation:!0,pushes:!0}),R=z({color:"#1D3742"}),A=function(e,t,n,a,r){return O((function(i){return{body:T.Bodies.rectangle(i(e),i(t),i(n),i(a),{isSensor:!0,render:{fillStyle:r,opacity:.5}}),meta:{color:r}}}))},V=n(3),C=function e(t,n){var a=this;Object(V.a)(this,e),this.startMove=function(e){a[e]=!0},this.stopMove=function(e){a[e]=!1},this.getVelocity=function(){return{x:((a.left?-1:0)+(a.right?1:0))*a.speed/1e3,y:((a.up?-1:0)+(a.down?1:0))*a.speed/1e3}},this.getAngularVelocity=function(){return((a.ccw?-1:0)+(a.cw?1:0))*a.angularSpeed/1e3},this.isMoving=function(){var e=a.getVelocity(),t=e.x,n=e.y;return t||n||a.getAngularVelocity()},this.speed=t,this.angularSpeed=n;for(var r=0,i=["up","down","left","right","cw","ccw"];r<i.length;r++){this[i[r]]=!1}},D=function e(t){var n=this;Object(V.a)(this,e),this.log=function(e){var t=n.history.length?n.history[n.history.length-1].position:n.body.position,a=T.Vector.sub(n.body.position,t),r=n.body.position,i=r.x,o=r.y;n.history.push({time:e,position:{x:i,y:o},delta:a})},this.clear=function(){n.history=[]},this.revertTo=function(e){for(var t=T.Vector.create(),a=n.history.length-1;a>=0;a--){var r=n.history[a],i=r.time,o=r.delta;if(t=T.Vector.sub(t,o),!(i>e)){T.Body.translate(n.body,t),n.history.splice(a,n.history.length);break}}},this.body=t,this.history=[]},I=["gravity","selectable","reversable","fixedRotation","bounded","fixedPosition"],F=function e(t,n){var r=this;Object(V.a)(this,e),this.start=function(){r.frozenVelocities={},r.activeObjectIndex=0,r.selectMovement=new C(r.normalize(500),20)},this.attachEventListeners=function(){r.registerCollisionListener("spirit","goal",r.level.onEnterGoal)},this.registerCollisionListener=function(e,t,n){var i=r.bodyMap[e].id,o=r.bodyMap[t].id;T.Events.on(r.level.loop.engine,"collisionStart",(function(e){var t,r=Object(a.a)(e.pairs);try{for(r.s();!(t=r.n()).done;){var s=t.value,l=s.bodyA,c=s.bodyB;if(l.id===i&&c.id===o||l.id===o&&c.id===i)return n()}}catch(u){r.e(u)}finally{r.f()}}))},this.normalize=function(e){return e/100*700},this.update=function(){r.updatePushes(),r.updateGravityBodies(),r.updateSelectables(),r.updateHistories(),r.updateReversables(),r.updateFixedRotations(),r.updateBoundeds(),r.updateFixedPositions(),r.checkSpiritOutOfBounds()},this.updatePushes=function(){var e=r.level.objectSelectOrder[r.activeObjectIndex],t=!r.metaMap[e].pushes&&r.level.frozen;r.byTrait.gravity.forEach((function(e){r.bodyMap[e].isStatic!==t&&T.Body.setStatic(r.bodyMap[e],t)}))},this.updateGravityBodies=function(){var e={x:0,y:0},t=r.level.frozen?function(t){T.Body.setVelocity(t,e)}:function(e){var t={x:0*e.mass,y:.002*e.mass};T.Body.applyForce(e,e.position,t)};r.byTrait.gravity.forEach((function(e){t(r.bodyMap[e])}))},this.updateSelectables=function(){var e=r.level.objectSelectOrder[r.activeObjectIndex];r.byTrait.selectable.forEach((function(t){var n=r.bodyMap[t],a=r.metaMap[t],i=a.color,o=a.selectColor,s=a.live,l=a.fixedRotation,c=a.fixedPosition,u=r.selectMovement;u.isMoving()||n.isStatic||T.Body.setStatic(n,!0);var d=t===e,f=!!s!==r.level.frozen,v=i;d&&f&&(v=o,u.isMoving()&&(T.Body.setStatic(n,!1),c||T.Body.setVelocity(n,u.getVelocity()),l||T.Body.setAngularVelocity(n,u.getAngularVelocity()))),n.render.fillStyle=v}))},this.updateHistories=function(){r.level.frozen||r.byTrait.reversable.forEach((function(e){r.histories[e].log(r.level.getPlayTime())}))},this.updateReversables=function(){if(r.level.reversed){var e=r.level.getPlayTime();for(var t in r.histories)r.histories[t].revertTo(e)}},this.updateFixedRotations=function(){r.byTrait.fixedRotation.forEach((function(e){T.Body.setAngle(r.bodyMap[e],0)}))},this.updateFixedPositions=function(){r.byTrait.fixedPosition.forEach((function(e){var t=r.fixedPositions[e],n=t.x,a=t.y;T.Body.setPosition(r.bodyMap[e],{x:n,y:a})}))},this.checkSpiritOutOfBounds=function(){var e=r.bodyMap.spirit.position,t=e.x,n=e.y,a=-r.normalize(20),i=700+r.normalize(20);(t<=a||n<=a||t>=i||n>=i)&&r.level.onSpiritOutOfBounds()},this.updateBoundeds=function(){var e=r.normalize(1);r.byTrait.bounded.forEach((function(t){var n=r.bodyMap[t],a=r.metaMap[t].bounded,i=r.bodyMap[a],o=Object(l.a)(n.vertices,4),s=o[0],c=o[1],u=o[2],d=o[3],f=Object(l.a)(i.vertices,3),v=f[0],h=f[2],y=0,m=0,p=Math.min(s.y,c.y),b=Math.min(s.x,d.x),g=Math.max(u.y,d.y),E=Math.max(u.x,c.x),w=v.y+e,x=v.x+e,S=h.y-e,O=h.x-e;p<w&&(m+=w-p),g>S&&(m-=g-S),b<x&&(y+=x-b),E>O&&(y-=E-O),(y||m)&&T.Body.translate(n,{x:y,y:m})}))},this.freeze=function(){var e={};r.byTrait.gravity.forEach((function(t){var n=r.bodyMap[t].velocity,a=n.x,i=n.y;e[t]={x:a,y:i}})),r.frozenVelocities=e},this.unfreeze=function(){r.byTrait.gravity.forEach((function(e){var t=r.frozenVelocities[e];if(t){var n=t.x,a=t.y;T.Body.setVelocity(r.bodyMap[e],{x:n,y:a})}}))},this.selectNext=function(){var e=r.activeObjectIndex+1;e>=r.level.objectSelectOrder.length&&(e=0),r.activeObjectIndex=e},this.moveSelected=function(e){r.selectMovement.startMove(e)},this.stopMovingSelected=function(e){r.selectMovement.stopMove(e)},this.level=t;var i=[],o={},s={},c={},u={},d={};for(var f in I.forEach((function(e){return d[e]=[]})),n){var v=n[f](this.normalize),h=v.body,y=v.meta;i.push(h),o[f]=h,s[f]=y;var m,p=Object(a.a)(I);try{for(p.s();!(m=p.n()).done;){var b=m.value;void 0!==y[b]&&d[b].push(f)}}catch(x){p.e(x)}finally{p.f()}if(y.reversable&&(c[f]=new D(h)),y.fixedPosition){var g=h.position,E=g.x,w=g.y;u[f]={x:E,y:w}}}this.all=i,this.bodyMap=o,this.metaMap=s,this.byTrait=d,this.histories=c,this.fixedPositions=u},L=function e(t,n){var a=this;Object(V.a)(this,e),this.start=function(e,t,n){a.render=T.Render.create({element:e,engine:a.engine,options:{wireframes:!1,width:700,height:700,background:"#03171B"}}),T.Render.world(a.render),a.intervalRef=setInterval(a.update,10),a.playTime=0},this.update=function(){a.globalTime+=10,a.level.reversed?a.playTime=Math.max(0,a.playTime-10):a.level.frozen||(a.playTime+=10),a.level.blockingEvent||(a.level.update(),T.Engine.update(a.engine,10),T.Render.world(a.render))},this.teardown=function(){a.intervalRef=clearInterval(a.intervalRef),T.Render.stop(a.render),T.World.clear(a.engine.world),T.Engine.clear(a.engine),a.render.canvas.remove(),setTimeout((function(){a.render.canvas=null,a.render.context=null,a.render.textures={}}),10)},this.level=t,this.globalTime=0,this.engine=T.Engine.create(),this.engine.world.gravity.scale=0,T.World.add(this.engine.world,n)},W=function e(t,n){var a=this;Object(V.a)(this,e),this.init=function(e,t,n){a.ref=e,a.onEnterGoal=t,a.initialized=!0},this.start=function(){a.bodies=new F(a,a.bodiesInitializer),a.loop=new L(a,a.bodies.all),a.bodies.start(),a.loop.start(a.ref),a.bodies.attachEventListeners(),a.started=!0,a.frozen=!0,a.events=[],a.blockingEvent=!1},this.update=function(){if(a.events.length){a.blockingEvent=!0;var e=a.events.shift();a.executeEvent(e),a.blockingEvent=!1}a.bodies.update()},this.handleGameKeyEvent=function(e){a.events.push(e)},this.executeEvent=function(e){var t=e.type,n=e.data;switch(t){case d:return a.frozen?a.unfreeze():a.freeze();case f:return a.restart();case v:return a.bodies.selectNext();case m:case b:return a.bodies.moveSelected(n);case p:case g:return a.bodies.stopMovingSelected(n);case h:return a.reverse();case y:return a.forward();default:console.log("not handled",t)}},this.teardown=function(){a.loop.teardown()},this.restart=function(){a.teardown(),a.start()},this.getPlayTime=function(){return a.loop.playTime},this.freeze=function(){a.frozen=!0,a.bodies.freeze()},this.unfreeze=function(){a.frozen=!1,a.bodies.unfreeze()},this.reverse=function(){a.freeze(),a.reversed=!0},this.forward=function(){a.reversed=!1},this.onSpiritOutOfBounds=function(){a.restart()},this.bodiesInitializer=t,this.objectSelectOrder=n,this.initialized=!1},K=[{name:"Lander",level:function(){return new W({spirit:B(10,10,2),ground:j(42,80,80,2),goal:M(90,90,4)},["ground"])}},{name:"Landerer",level:function(){return new W({spirit:B(10,10,2),ground:j(42,80,30,2),goal:M(90,90,4)},["ground"])}},{name:"Push",level:function(){return new W({goal:M(90,90,4),spirit:B(20,10,2),pusherBound:A(45,60,80,10,"#7E262E"),pusher:P(10,60,8,8,0,"pusherBound"),ground:R(20,30,30,2,.5)},["pusher"])}},{name:"Tower",level:function(){return new W({goal:M(50,20,4),spirit:B(20,10,2),pusherBound:A(50,90,90,10,"#7E262E"),pusher:P(90,90,8,8,0,"pusherBound"),wall1:R(50,10,24,2),wall2:R(39,45,2,70),wall3:R(61,45,2,70)},["pusher"])}},{name:"Plateau",level:function(){return new W({goal:M(20,80,4),spirit:B(10,5,2),topWall:k(40,30,70,2),goalShield:R(20,65,50,2,-.5),pusherBound:A(80,80,38,38,"#7E262E"),pusher:P(90,90,8,8,0,"pusherBound")},["topWall","pusher"])}}];var G=function(e){e.onSetLevel;var t=e.onAnyKey;return i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{handleKeys:["numeric"],onKeyEvent:function(e){0}}),i.a.createElement(u.a,{handleKeys:["all"],onKeyEvent:t}))},N=(n(20),n(21),n(9)),q=n.n(N);function H(e){e.totalRetries;return i.a.createElement("div",{className:"TutorialSlide"},i.a.createElement("div",null,"As you roll the orb into the last goal, the VHS sputters out. For the last time, you guess."),i.a.createElement("div",null,'From far away, you hear a quiet voice: "My thanks"'),i.a.createElement("div",{style:{opacity:.6}},"Thank you for playing Play<<Back! This game was created in 48 hours for Ludum Dare 46. If you have any feedback, go to github.com/jcowman2/play-back"),i.a.createElement("div",{style:{opacity:.6,textAlign:"right"}},"-Joe"))}var _=[function(){return i.a.createElement("img",{src:q.a,alt:"PlayBack Title"})},function(){return i.a.createElement("div",{className:"TutorialSlide"},i.a.createElement("div",null,"It is a warm Wednesday night the summer after you turned ten."),i.a.createElement("div",null,"Searching for something to do at your grandparents' house, you stumble upon a dusty old TV with a VCR."),i.a.createElement("div",null,"Something about the VCR calls to you."),i.a.createElement("div",null,'Suddenly, a tiny orb blinks onto the screen. "Save me" it says....'),i.a.createElement("div",{style:{opacity:.3}},"Press any key to continue."))}],J=[i.a.createElement("div",{style:{left:400,top:50,maxWidth:300}},i.a.createElement("div",null,"Try to get the ball into the goal."),i.a.createElement("div",null,"Use WASD to move the platform, and QE to rotate it."),i.a.createElement("div",null,"Hit play/pause with SPACE.")),i.a.createElement("div",{style:{left:300,top:150,maxWidth:400}},i.a.createElement("div",null,"You can use time to your advantage!"),i.a.createElement("div",null,"Press R to retry.")),i.a.createElement("div",{style:{left:300,top:100,maxWidth:400}},i.a.createElement("div",null,"Red walls can push the orb around when time is stopped, but they can't leave their area.")),i.a.createElement("div",{style:{left:220,top:10,maxWidth:400}},i.a.createElement("div",null,"Hold SHIFT to rewind!")),i.a.createElement("div",{style:{left:220,top:10,maxWidth:400}},i.a.createElement("div",null,"Press CTRL to switch control between blocks."),i.a.createElement("div",null,"Some blocks can only rotate in place."))];var U=function(){var e=i.a.useState(),t=Object(l.a)(e,2),n=t[0],a=t[1],r=i.a.useState(),o=Object(l.a)(r,2),s=o[0],c=o[1],u=i.a.useState(0),d=Object(l.a)(u,2)[1],f=i.a.useState(0),v=Object(l.a)(f,2),h=v[0],y=v[1],m=function(){var e=i.a.useState(!0),t=Object(l.a)(e,2),n=t[0],a=t[1],r=i.a.useState("INPUT"),o=Object(l.a)(r,2),s=o[0],c=o[1],u=i.a.useState(3e3),d=Object(l.a)(u,2),f=d[0],v=d[1];return i.a.useEffect((function(){!s||f<0||setTimeout((function(){return c(null)}),f)}),[s,f]),{setAnimate:a,monitorClass:"Monitor"+(n?" TurnOn":""),overlayText:s,setOverlayText:c,setOverlayTextDuration:v}}(),p=m.setAnimate,b=m.monitorClass,g=m.overlayText,E=m.setOverlayText,w=function(e){s&&s.teardown(),a(e),c(K[e].level()),p(!0),E(function(e){return"".concat(e+1,": ").concat(K[e].name)}(e))},x=h<0?i.a.createElement(H,{totalRetries:0}):_[h]();return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:b,onAnimationEnd:function(){return p(!1)}},i.a.createElement("div",{className:"Screen"},s?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"InstructionOverlay"},J[n]),i.a.createElement(S,{data:s,onUpdateData:function(){d((function(e){return e+1}))},onEnterGoal:function(){n===K.length-1?(c(null),y(-1)):w(n+1)}})):x),i.a.createElement("div",{className:"Overlay"},g)),i.a.createElement(G,{onSetLevel:w,onAnyKey:function(){s||(h===_.length-1?w(0):y((function(e){return e+1})))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}));for(var Q=["mousedown","keydown"],Y=function e(){document.getElementById("music").play();var t,n=Object(a.a)(Q);try{for(n.s();!(t=n.n()).done;){var r=t.value;document.removeEventListener(r,e)}}catch(i){n.e(i)}finally{n.f()}},$=0,X=Q;$<X.length;$++){var Z=X[$];document.addEventListener(Z,Y)}},9:function(e,t,n){e.exports=n.p+"static/media/LD Square.ad3b42a3.png"}},[[10,1,2]]]);
//# sourceMappingURL=main.c2dd1774.chunk.js.map